{% extends "layout.html" %}
{% block main %}
<div class="row-fluid">
    <div class="span9">
        <div class="card">
            <div class="card-heading image">
                <div class="card-heading-header">
                    <h1>{{ subject.title }}</h1>
                </div>
                <div class="row-fluid">
                        <div class="span6 card-heading-header">
                            <span><strong>COURSE CODE: </strong>{{ subject.code }}</span>
                            </br>
                            <span><strong>SLOT</strong>: {{ subject.slot }}</span>
                        </div>
                        <div class="span6 card-heading-header">
                            <span><strong>TYPE</strong>: {{ subject.type }}</span>
                            </br>
                            <span><strong>REGISTRATION DATE</strong>: {{ subject.regdate }}</span>
                        </div>
                    </div>
            </div>
             <div class="card-body" style="margin-top: 0px;">
             <div class="row-fluid">
                <div class="span10" style="margin-top: 26px;">
                     <div class="progress progress-{% if (subject.percentage|replace("%","")) >= 80 %}success{% elif (subject.percentage|replace("%","")) >= 75 %}warning{% else %}danger{% endif %}">
                        <div class="bar" style="width: {{ subject.percentage }}"></div>
                     </div>
                </div>
                <div class="span2">
                    <h1>{{ subject.percentage }}</h1>
                </div>
             </div>
             <h4 style="margin-top: 0px;">You have attended <strong>{{ subject.attended }}</strong> out of <strong>{{ subject.conducted }} classes</strong></h4>
             </div>
        </div>
        <div class="row-fluid">
            <div class="span4">
                <div class="card">
                    <div class="card-heading image">
                        <div class="card-heading-header">
                            <h3>Course Schedule</h3>
                            <span>Weekly schedule for {{ subject.title }}</span>
                        </div>
                    </div>
                    <div class="card-body" style="height: 320px; overflow-y: auto;">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Day</th>
                                    <th>Time</th>
                                </tr>
                            </thead>
                          <tbody>
                              {% if subject.timetable['Monday'] %}
                          <tr>
                              <td>Monday</td>
                              <td>{{ subject.timetable['Monday'] }}</td>
                          </tr>
                              {% endif %}
                              {% if subject.timetable['Tuesday'] %}
                          <tr>
                              <td>Tuesday</td>
                              <td>{{ subject.timetable['Tuesday'] }}</td>
                          </tr>
                              {% endif %}
                              {% if subject.timetable['Wednesday'] %}
                          <tr>
                              <td>Wednesday</td>
                              <td>{{ subject.timetable['Wednesday'] }}</td>
                          </tr>
                              {% endif %}
                              {% if subject.timetable['Thursday'] %}
                          <tr>
                              <td>Thursday</td>
                              <td>{{ subject.timetable['Thursday'] }}</td>
                          </tr>
                              {% endif %}
                              {% if subject.timetable['Friday'] %}
                          <tr>
                              <td>Friday</td>
                              <td>{{ subject.timetable['Friday'] }}</td>
                          </tr>
                              {% endif %}
                          </tbody>
                      </table>
                    </div>
                </div>
            </div>
            <div class="span4">
                <div class="card">
                    <div class="card-heading image">
                        <div class="card-heading-header">
                            <h3>Course Scores</h3>
                            <span>Marks obtained in {{ subject.title }}</span>
                        </div>
                    </div>
                    <div class="card-body" style="height: 320px; overflow-y: auto;">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>Criteria</th>
                                    <th>Your Score</th>
                                </tr>
                            </thead>
                          <tbody>
                          {% for c,s in subject.marks.iteritems()|sort %}
                          <tr>
                              <td>{{ c }}</td>
                              <td>{{ s }}</td>
                          </tr>
                          {% endfor %}
                          </tbody>
                      </table>
                    </div>

                </div>
            </div>
            <div class="span4">
                <div class="card">
                    <div class="card-heading image">
                              <div class="card-heading-header">
                                 <h3>Attendance Details</h3>
                                 <span><strong>Last Updated On: </strong>{{ subject.details[subject.details|length-2] }}</span>
                              </div>
                    </div>
                    <div class="card-body" style="height: 320px; overflow-y: auto;">
                    <table class="table table-hover">
                          <thead>
                            <tr>
                              <th>Date</th>
                              <th>Status</th>
                            </tr>
                          </thead>
                          <tbody>
                          {% for detail in subject.details|batch(2) %}
                            <tr>
                              <td>{{ detail[0] }}</td>
                              {% if detail[1] == "Absent" %}
                                <td><span class="label label-important">{{ detail[1] }}</span></td>
                              {% elif detail[1] == "Present" %}
                                  <td><span class="label label-success">{{ detail[1] }}</span></td>
                              {% else %}
                                   <td><span class="label label-warning">{{ detail[1] }}</span></td>
                              {% endif %}
                            </tr>
                          {% endfor %}
                          </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="span3">
        <div class="card">
            <div class="card-heading image">
                      <div class="card-heading-header">
                         <h3>Notices</h3>
                         <span>Recent updates</span>
                      </div>
            </div>
            <div class="card-body">
                <table class="table table-bordered table-striped">
                      <tbody>
                        {% for notice in notices %}
                        <tr>
                            <td>
                                <h4><strong>{{ notice.text }}</strong></h4>
                                {% if notice.author == "11BCE0354" %}
                                <p onclick='location.href="/noticedel/{{ notice.id }}/{{ subject.classnbr }}"' style="cursor: pointer; float: right;">x</p>
                                {% endif %}
                                <p style="font-style: italic;">By {{ notice.author  }} at {{ notice.timestamp }}</p>
                            </td>
                        </tr>
                        {% endfor %}
                      </tbody>
                </table>

                <form class="input-prepend" action="/notice" onsubmit="setTimeout(function () { window.location.reload(); }, 10)" method="post">
                  <input class="span12" name="text" type="text" placeholder="Quiz on Monday!">
                  <input type="hidden" name="cnum" value="{{ subject.classnbr }}">
                  <input type="hidden" name="author" value="11BCE0354">
                  <button type="submit" class="btn">Post</button>
                </form>
                <p class="muted">Sometimes you need to reload the page after posting/deleting a notice.</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block footer %}{% include "footer.html" %}{% endblock %}